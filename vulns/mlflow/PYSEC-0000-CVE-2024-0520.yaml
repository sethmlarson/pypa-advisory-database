id: PYSEC-0000-CVE-2024-0520
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
details: A vulnerability in mlflow/mlflow version 8.2.1 allows for remote code execution
  due to improper neutralization of special elements used in an OS command ('Command
  Injection') within the `mlflow.data.http_dataset_source.py` module. Specifically,
  when loading a dataset from a source URL with an HTTP scheme, the filename extracted
  from the `Content-Disposition` header or the URL path is used to generate the final
  file path without proper sanitization. This flaw enables an attacker to control
  the file path fully by utilizing path traversal or absolute path techniques, such
  as '../../tmp/poc.txt' or '/tmp/poc.txt', leading to arbitrary file write. Exploiting
  this vulnerability could allow a malicious user to execute commands on the vulnerable
  machine, potentially gaining access to data and model information. The issue is
  fixed in version 2.9.0.
affected:
- package:
    name: mlflow
    ecosystem: PyPI
    purl: pkg:pypi/mlflow
  ranges:
  - type: GIT
    repo: https://github.com/mlflow/mlflow
    events:
    - introduced: "0"
    - fixed: 400c226953b4568f4361bc0a0c223511652c2b9d
    - fixed: 400c226953b4568f4361bc0a0c223511652c2b9d
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 2.9.0
references:
- type: EVIDENCE
  url: https://huntr.com/bounties/93e470d7-b6f0-409b-af63-49d3e2a26dbc
- type: FIX
  url: https://github.com/mlflow/mlflow/commit/400c226953b4568f4361bc0a0c223511652c2b9d
- type: FIX
  url: https://huntr.com/bounties/93e470d7-b6f0-409b-af63-49d3e2a26dbc
- type: REPORT
  url: https://huntr.com/bounties/93e470d7-b6f0-409b-af63-49d3e2a26dbc
- type: WEB
  url: https://huntr.com/bounties/93e470d7-b6f0-409b-af63-49d3e2a26dbc
aliases:
- CVE-2024-0520
modified: "2024-11-21T08:46:46Z"
published: "2024-06-06T19:15:51Z"
